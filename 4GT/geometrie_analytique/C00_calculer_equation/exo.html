<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Let's go Math !</title>

<!-- CSS -->
<link rel="stylesheet" href="../../../style.css">
<link rel="stylesheet" href="../../../exercices.css">

<!-- Bootstrap -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

<!-- MathJax -->
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>

<body>

<nav class="lgm-navbar">
  <ul class="nav-liste">
    <li><a href="../../../index.html">Accueil</a></li>
    <li><a href="../../../index.html#dia2">4GT</a></li>
    <li><a href="../../../index.html#dia3">5GT 6h</a></li>
    <li><a href="../../../index.html#dia4">6GT 6h</a></li>
  </ul>
</nav>

<div class="exo-container">
  <h1>Exercice</h1>

<div class="enonce">
  <p id="enonce"></p>
</div>

  <div class="question">
    <label for="reponse">Équation de la droite :</label>
    <input type="text" id="reponse" class="form-control" placeholder="Ex : y = 2x - 3">
  </div>

  <div class="btn-container">
    <button class="btn btn-success" onclick="verifier()">Vérifier</button>
    <button class="btn btn-info" onclick="afficherResolution()">Résolution</button>
    <button class="btn btn-secondary" onclick="nouvelExo()">Nouvel exercice</button>
  </div>

  <div id="feedback" class="feedback"></div>
  <div id="solution" class="solution"></div>
</div>

<script>
let m, e, f, p;

function nouvelExo() {
  m = Math.floor(Math.random() * 7) - 3;
  while (m === 0) m = Math.floor(Math.random() * 7) - 3;

  e = Math.floor(Math.random() * 7) - 3;
  f = Math.floor(Math.random() * 7) - 3;

  p = f - m * e;

  document.getElementById("reponse").value = "";
  document.getElementById("feedback").innerHTML = "";
  document.getElementById("solution").innerHTML = "";

  document.getElementById("enonce").innerHTML =
    `Calcule l'équation réduite de la droite \\( d \\) de pente \\(${m}\\) passant par le point \\(A(${e};${f})\\).`;

  MathJax.typeset();
}

function normaliser(str) {
  return str
    .replace(/\s+/g, "")
    .replace(/y=/, "")
    .replace(/\+0$/, "");
}

function verifier() {
  const rep = normaliser(document.getElementById("reponse").value);

  let attendu = `y=${m}x`;
  if (p > 0) attendu += `+${p}`;
  if (p < 0) attendu += `${p}`;

  if (normaliser(attendu) === normaliser("y=" + rep)) {
    document.getElementById("feedback").innerHTML =
      "<span class='bon'>✅ Réponse correcte</span>";
  } else {
    document.getElementById("feedback").innerHTML =
      "<span class='faux'>❌ Réponse incorrecte</span>";
  }
}

function afficherResolution() {
  let texte = `
  <p><strong>On cherche une équation de la forme :</strong></p>
  \\[
  y = mx + p
  \\]

  <p>On connaît \\(m = ${m}\\) et le point \\(A(${e};${f})\\).</p>

  <p>On remplace :</p>
  \\[
  ${f} = ${m} \\cdot ${e} + p
  \\]

  <p>On calcule :</p>
  \\[
  ${f} = ${m * e} + p
  \\]

  <p>Donc :</p>
  \\[
  p = ${f} - ${m * e} = ${p}
  \\]

  <p><strong>Équation de la droite :</strong></p>
  \\[
  y = ${m}x ${p > 0 ? "+" + p : p < 0 ? p : ""}
  \\]
  `;

  document.getElementById("solution").innerHTML = texte;
  MathJax.typeset();
}

nouvelExo();
</script>

</body>
</html>
