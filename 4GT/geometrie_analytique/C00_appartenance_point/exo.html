<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Let's go Math !</title>

<link rel="stylesheet" href="../../../style.css">
<link rel="stylesheet" href="../../../exercices.css">

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>

<body>

<nav class="lgm-navbar">
  <ul class="nav-liste">
    <li><a href="../../../index.html">Accueil</a></li>
    <li><a href="../../../index.html#dia2">4GT</a></li>
    <li><a href="../../../index.html#dia3">5GT 6h</a></li>
    <li><a href="../../../index.html#dia4">6GT 6h</a></li>
  </ul>
</nav>

<div class="exo-container">
  <h1>Exercice</h1>

  <div class="equation-box" id="enonce"></div>

  <input type="text" id="reponse" placeholder="oui ou non">

  <button onclick="verifier()">V√©rifier</button>
  <button onclick="corriger()">Correction</button>
  <button onclick="generer()">Nouvel exercice</button>

  <p id="feedback" class="feedback"></p>

  <div class="exo-links">
    <a href="../../4GT_geo_analytique.html">Retour au menu</a>
  </div>
</div>

<script>
/* ===================== OUTILS ===================== */
function renderMath(el){
  MathJax.typesetClear([el]);
  MathJax.typesetPromise([el]);
}

function randInt(){
  let x;
  do { x = Math.floor(Math.random()*11)-5; }
  while(x === 0);
  return x;
}

function randFrac(){
  const num = randInt();
  const den = randInt();
  return {num, den};
}

function valFrac(f){ return f.num / f.den; }

/* ===================== VARIABLES ===================== */
let e, f;
let texteCorrection = "";
let appartient = false;

/* ===================== GENERATION ===================== */
function generer(){

  const type = Math.random();
  appartient = Math.random() < 0.5;

  let enonce = "";

  /* ===== CAS 1 : y = mx + p ===== */
  if(type < 0.4){

    const m = randFrac();
    const p = randFrac();

    e = randInt();
    f = appartient
      ? valFrac(m)*e + valFrac(p)
      : valFrac(m)*e + valFrac(p) + randInt();

    enonce = `La droite a pour √©quation :
    \\(y = ${m.num}/${m.den}x + ${p.num}/${p.den}\\)<br>
    Le point \\(A(${e};${f})\\) appartient-il √† cette droite ?`;

    texteCorrection =
      `On teste :<br>
      \\(f = m\\times e + p\\)<br>
      \\(${f} ${appartient ? "=" : "\\neq"} ${valFrac(m)*e + valFrac(p)}\\)`;
  }

  /* ===== CAS 2 : x = k ===== */
  else if(type < 0.7){

    const k = randFrac();

    e = appartient ? valFrac(k) : valFrac(k) + randInt();
    f = randInt();

    enonce = `La droite a pour √©quation :
    \\(x = ${k.num}/${k.den}\\)<br>
    Le point \\(A(${e};${f})\\) appartient-il √† cette droite ?`;

    texteCorrection =
      `On teste :<br>
      \\(x = ${e} ${appartient ? "=" : "\\neq"} ${valFrac(k)}\\)`;
  }

  /* ===== CAS 3 : ax + by + c = 0 ===== */
  else {

    const a = randInt();
    const b = randInt();
    const c = randInt();

    e = randInt();
    f = appartient
      ? (-a*e - c)/b
      : (-a*e - c)/b + randInt();

    enonce = `La droite a pour √©quation :
    \\(${a}x + ${b}y + ${c} = 0\\)<br>
    Le point \\(A(${e};${f})\\) appartient-il √† cette droite ?`;

    texteCorrection =
      `On calcule :<br>
      \\(${a}\\times${e} + ${b}\\times${f} + ${c}
      ${appartient ? "= 0" : "\\neq 0"}\\)`;
  }

  const div = document.getElementById("enonce");
  div.innerHTML = enonce;
  renderMath(div);

  document.getElementById("reponse").value = "";
  document.getElementById("feedback").innerHTML = "";
}

/* ===================== VERIFIER ===================== */
function verifier(){
  const r = document.getElementById("reponse").value.trim().toLowerCase();
  const fdb = document.getElementById("feedback");

  if(r !== "oui" && r !== "non"){
    fdb.style.color = "red";
    fdb.innerHTML = "‚ùå R√©ponse attendue : oui ou non";
    return;
  }

  if((r === "oui") === appartient){
    fdb.style.color = "green";
    fdb.innerHTML = "‚úÖ Correct";
  } else {
    fdb.style.color = "red";
    fdb.innerHTML = "‚ùå Incorrect";
  }
}

/* ===================== CORRECTION ===================== */
function corriger(){
  const fdb = document.getElementById("feedback");
  fdb.style.color = "#000";
  fdb.innerHTML = `üìò <strong>Correction</strong><br><br>${texteCorrection}`;
  renderMath(fdb);
}

/* ===================== INIT ===================== */
generer();
</script>

<script src="../../../js/protection.js"></script>

</body>
</html>
