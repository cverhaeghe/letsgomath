<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Let's go Math !</title>

<!-- CSS -->
<link rel="stylesheet" href="../../../style.css">
<link rel="stylesheet" href="../../../exercices.css">

<!-- Bootstrap -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

<!-- MathJax v3 -->
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>

<body>

<nav class="lgm-navbar">
  <ul class="nav-liste">
    <li><a href="../../../index.html">Accueil</a></li>
    <li><a href="../../../index.html#dia2">4GT</a></li>
    <li><a href="../../../index.html#dia3">5GT 6h</a></li>
    <li><a href="../../../index.html#dia4">6GT 6h</a></li>
  </ul>
</nav>

<div class="exo-container">
  <h1>Exercice</h1>

  <div class="equation-box" id="equation"></div>

  <input type="text" id="reponse" placeholder="">

  <button onclick="verifier()">VÃ©rifier</button>
  <button onclick="corriger()">Correction</button>
  <button onclick="genererEquation()">Nouvel exercice</button>

  <p id="feedback" class="feedback"></p>

  <div class="exo-links">
    <a href="../../4GT_geo_analytique.html">Retour au menu</a>
  </div>
</div>

<script>
/* ====================== OUTILS MATHJAX ====================== */
function renderMath(el){
  MathJax.typesetClear([el]);
  MathJax.typesetPromise([el]);
}

/* ====================== VARIABLES ====================== */
let a, b, c;
let equationTextePourCorrection = "";

/* ====================== UTILITAIRES ====================== */
function randCoeff(){ return Math.floor(Math.random()*41)-20; }
function randCoeffNonZero(){ let x; do{x=randCoeff();}while(x===0); return x; }

function pgcd(x, y){
  x = Math.abs(x);
  y = Math.abs(y);
  while (y !== 0) {let t = y;y = x % y;x = t;}
  return x;
}

function FractionIrreductible(num, den) {
    const p = pgcd(num, den);
    return {
      num: num / p,
      den: den / p
      };
    }

function fractionLaTeX(num, den){
  if(num === 0) return "0";
  if(den === 1) return num.toString();
  return (num < 0 ? "-" : "") + `\\frac{${Math.abs(num)}}{${den}}`;
}

/* ====================== GENERATION ====================== */
function genererEquation(){

  // ---- droite verticale uniquement ----
  a = randCoeffNonZero();
  b = 0;
  c = randCoeffNonZero();

  // construction du texte ax + c
  let terms = [];
  terms.push((a === 1 ? '' : (a === -1 ? '-' : a)) + 'x');

  if(c !== 0){
    terms.push((c > 0 ? '+ ' : '- ') + Math.abs(c));
  }

  equationTextePourCorrection = terms.join(' ');

  const eqDiv = document.getElementById("equation");
  eqDiv.innerHTML =
    `RÃ©duis lâ€™Ã©quation de la droite : \\(${equationTextePourCorrection} = 0\\).`;
  renderMath(eqDiv);

  document.getElementById("reponse").value = "";
  document.getElementById("feedback").innerHTML = "";
}



/* ====================== CORRECTION ====================== */
function corriger(){

  const f = document.getElementById("feedback");
  f.style.color = "#000";

  let texte = `ðŸ“˜ <strong>Correction dÃ©taillÃ©e</strong><br><br>
  \\(${equationTextePourCorrection} = 0\\)<br><br>`;

  let num, den;

  if (a > 0 && c > 0) { 
    texte += `Ã‰tape 1 : on isole \\(${a}x\\) <br>
        \\(${a}x = ${-c}\\)<br><br>
        
    Ã‰tape 2 : on divise tout par ${a} <br>`;

    num = c;
    den = a;
    const frac1 = fractionLaTeX(den, den);
    const frac2 = fractionLaTeX(num, den);

    texte += `\\( ${frac1} x = - ${frac2}\\)<br><br>`;

    texte += `Ã‰tape 3 : on simplifie <br>`;
       
    let frac = FractionIrreductible(c, a);
    texte += `\\(x = - \\frac{${frac.num}}{${frac.den}}\\)`;

    
  } else if (a > 0 && c < 0) {
    texte += `Ã‰tape 1 : on isole \\(${a}x\\) <br>
        \\(${a}x = ${-c}\\)<br><br>
        
    Ã‰tape 2 : on divise tout par ${a} <br>`;

    num = -c;
    den = a;
    const frac1 = fractionLaTeX(den, den);
    const frac2 = fractionLaTeX(num, den);

    texte += `\\( ${frac1} x = ${frac2}\\)<br><br>`;

    
  } else if (a < 0 && c > 0) {
    texte += `Ã‰tape 1 : comme \\( ${a}<0 \\), on passe \\(${a}x\\) Ã  droite <br>
        \\(${c} = ${Math.abs(a)}x\\)<br><br>
        
    Ã‰tape 2 : on divise tout par ${-a} <br>`;

    num = c;
    den = -a;
    const frac1 = fractionLaTeX(num, den);
    const frac2 = fractionLaTeX(den, den);

    texte += `\\( ${frac1} = ${frac2} x \\)<br><br>`;

  

  } else {
    texte += `Ã‰tape 1 : comme \\( ${a}<0 \\), on passe \\(${a}x\\) Ã  droite <br>
        \\(${c} = ${Math.abs(a)}x\\)<br><br>
        
    Ã‰tape 2 : on divise tout par ${-a} <br>`;

    num = -c;
    den = -a;
    const frac1 = fractionLaTeX(num, den);
    const frac2 = fractionLaTeX(den, den);

    texte += `\\( -${frac1} = ${frac2} x \\)<br><br>`;
    
  }
    


  f.innerHTML = texte;
  renderMath(f);
}

/* ====================== INIT ====================== */
genererEquation();
</script>

</body>
</html>
